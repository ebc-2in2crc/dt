# dt

dt は日付の計算や書式を変換するプログラムです.

## 説明

dt は, 日付を年や月などの単位で計算したり, 書式を変換します.

日付は, 年月日時分秒のいずれかの単位ごとに加算したり減算できます. たとえば, 以下のコマンドでシステム時刻の1年3ヶ月20秒前を調べられます.

```
$ dt now +1Y +3M +20s
```

計算元の日付を指定することもできます. 

```
$ dt "2018/05/12 17:30:00" +1Y +3M +20s
2019/08/12 17:30:20
```

日付のフォーマットは, 入力から自動で判断されます. 利用できるフォーマットについては --help の DATE FORMATS を参照してください.  また, 計算元の日付が数字のみで構成される場合は, 自動的に unix 秒と判断されます.

```
$ dt -o def 1526113800 +1Y +3M +20s
2019/08/12 17:30:20
```

--input-format, -i オプションにより, unix ミリ秒も指定できます.

```
$ dt -i unixm -o def 1526113800000 +1Y +3M +20s
2019/08/12 17:30:20
```

デフォルトでは出力フォーマットは入力フォーマットと同じですが, --output-format, -o オプションで出力フォーマットを指定できます.

```
$ dt 1526113800 +1Y +3M +20s
15300622820

$ dt -o "02 Jan 06 15:04 MST" 1526113800 +1Y +3M +20s
12 Aug 19 17:00 JST
```

## 使い方

```sh
$ date "+%Y/%m/%d %H:%M:%S"
2018/05/12 17:30:00

$ dt now +1Y +3M +20s
2019/08/12 17:30:20
```

### 計算元の日付を指定

```
$ dt "2018/05/12 17:30:00" +1Y +3M +20s
2019/08/12 17:30:20
```

### 日付の加算

```
$ dt "2018/05/12 17:30:00" +1Y
2019/05/12 17:30:00

$ dt "2018/05/12 17:30:00" +1M
2018/06/12 17:30:00

$ dt "2018/05/12 17:30:00" +1D
2018/05/13 17:30:00

$ dt "2018/05/12 17:30:00" +1h
2018/05/12 18:30:00

$ dt "2018/05/12 17:30:00" +1m
2018/05/12 17:31:00

$ dt "2018/05/12 17:30:00" +1s
2018/05/12 17:30:01

# '+' は省略できます
$ dt "2018/05/12 17:30:00" 1Y 3M 20s
2019/08/12 17:30:20
```

### 日付の減算

```
$ dt "2018/05/12 17:30:00" -1Y -3M -20s
2017/02/12 17:29:40
```

### 月末日の調整

```
$ dt "2018/01/31" +1M
2018/03/03


$ dt -a "2018/01/31" +1M
2018/02/28
```

### 入力フォーマット

#### dt 標準

```
$ dt "2018/05/12 17:30:00" +1Y +3M +20s
2019/08/12 17:30:20
```

#### RFC822

```
$ dt -o def "12 May 18 17:30 MST" +1Y +3M +20s
2019/08/12 17:30:20
```

#### unix 秒

```
$ dt -o def 1526113800 +1Y +3M +20s
2019/08/12 17:30:20
```

#### 自動判断されるフォーマット

設定ファイルに定義されたフォーマットと、以下のフォーマットは自動判断されます.

- 2006/01/02 15:04:05
- 2006-01-02 15:04:05
- 2006/01/02 15:04
- 2006-01-02 15:04
- 2006/01/02
- 2006-01-02
- Mon Jan _2 15:04:05 2006
- Mon Jan _2 15:04:05 MST 2006
- Mon Jan 02 15:04:05 -0700 2006
- 02 Jan 06 15:04 MST
- 02 Jan 06 15:04 -0700
- Monday, 02-Jan-06 15:04:05 MST
- Mon, 02 Jan 2006 15:04:05 MST
- Mon, 02 Jan 2006 15:04:05 -0700
- 2006-01-02T15:04:05Z07:00

詳しくは [https://golang.org/src/time/format.go](https://golang.org/src/time/format.go) を参照してください.

### 設定ファイル

dt は起動時に設定ファイル (`~/.config/dt/.dt`) を読み込みます.

#### 設定ファイルの例

```
myformat = 02-Jan-06 15:04:05
yearonly = 2006
```

### 入力フォーマットを指定

#### unix ミリ秒

```
$ dt -i unixm -o def 1526113800000 +1Y +3M +20s
2019/08/12 17:30:20
``` 

#### カスタムフォーマットを直接指定

```
$ dt -i "02-Jan-06 15:04:05" -o def "12-May-18 17:30:00" +1Y +3M +20s
2019/08/12 17:30:20
```

#### 設定ファイルで定義されたカスタムフォーマット

```
$ cat ~/.config/dt/.dt
myformat = 02-Jan-06 15:04:05

$ dt -i myformat -o def "12-May-18 17:30:00" +1Y +3M +20s
2019/08/12 17:30:20

# 設定ファイルで定義されたフォーマットは省略可
$ dt -o def "12-May-18 17:30:00" +1Y +3M +20s
2019/08/12 17:30:20
```

### 出力フォーマット

デフォルトでは入力フォーマットと同じ

```
$ dt "2018-05-12 17:30:00" +1Y +3M +20s
2019-08-12 17:30:20

$ dt 1526113800 +1Y +3M +20s
15300622820
```

### 出力フォーマットを直接指定

```
$ dt -o def 1526113800 +1Y +3M +20s
2019/08/12 17:30:20

$ dt -o "02-Jan-06 15:04:05" 1526113800 +1Y +3M +20s
12-Aug-19 17:30:20
```

### 設定ファイルで定義されたカスタムフォーマット

```
$ cat ~/.config/dt/.dt
myformat = 02-Jan-06 15:04:05

$ dt -o myformat 1526113800 +1Y +3M +20s
12-Aug-19 17:30:20
```

### ヘルプ

```
$ dt --help
# ...

```

## インストール

### 開発者向け

```
$ go get github.com/ebc-2in2crc/dt
$ cd $GOPATH/src/github.com/ebc-2in2crc/dt
$ make deps
$ make install
```

### 一般ユーザー向け

次の URL からダウンロードしてください.

- [https://github.com/ebc-2in2crc/dt/releases](https://github.com/ebc-2in2crc/dt/releases)

あるいは, Homebrew を使うこともできます (macOS のみ)

```sh
$ brew tap ebc-2in2crc/dt
$ brew install dt
```

## コントリビューション

1. このリポジトリをフォークします
2. issue ブランチを作成します (`git checkout -b issue/:id`)
3. コードを変更します
4. `make test` でテストを実行し, パスすることを確認します
5. `make fmt` でコードをフォーマットします
6. 変更をコミットします (`git commit -am 'Add some feature'`)
7. 新しいプルリクエストを作成します

## ライセンス

[MIT](https://github.com/ebc-2in2crc/dt/blob/master/LICENSE)

## 作者

[ebc-2in2crc](https://github.com/ebc-2in2crc)
